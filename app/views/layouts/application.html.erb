<!DOCTYPE html>
<html>
  <head>
    <title><%= content_for(:title) || "Foresight" %></title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="application-name" content="Foresight">
    <meta name="mobile-web-app-capable" content="yes">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= yield :head %>

    <!-- Custom Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Darker+Grotesque:wght@400;500;600;700;800&family=Manrope:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">

    <link rel="icon" href="/icon.png" type="image/png">
    <link rel="icon" href="/icon.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="/icon.png">

    <%= stylesheet_link_tag :app, "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>
  </head>

  <body class="bg-neutral-50 min-h-screen antialiased">
    <nav class="sticky top-0 z-30 bg-white shadow-soft border-b border-neutral-200" data-controller="mobile-menu">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between h-16">
          <div class="flex">
            <div class="flex-shrink-0 flex items-center">
              <%= link_to root_path, class: "flex items-center gap-2 group" do %>
                <div class="w-8 h-8 bg-gradient-to-br from-primary-600 to-primary-500 rounded-lg flex items-center justify-center p-1.5">
                  <svg class="w-full h-full text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z" />
                  </svg>
                </div>
                <span class="text-xl font-display font-bold text-neutral-900">Foresight</span>
              <% end %>
            </div>
            <div class="hidden sm:ml-8 sm:flex sm:space-x-8">
              <%= link_to "Dashboard", root_path, class: current_page?(root_path) ? 'nav-link-active' : 'nav-link-inactive' %>
              <%= link_to "Accounts", accounts_path, class: current_page?(accounts_path) ? 'nav-link-active' : 'nav-link-inactive' %>
              <%= link_to "Transactions", transactions_path, class: current_page?(transactions_path) ? 'nav-link-active' : 'nav-link-inactive' %>
              <%= link_to "Rules", recurring_rules_path, class: current_page?(recurring_rules_path) ? 'nav-link-active' : 'nav-link-inactive' %>
              <%= link_to "Settings", edit_settings_path, class: current_page?(edit_settings_path) ? 'nav-link-active' : 'nav-link-inactive' %>
            </div>
          </div>
          <div class="flex items-center gap-2">
            <!-- Mobile menu button -->
            <button
              type="button"
              class="sm:hidden inline-flex items-center justify-center p-2 rounded-lg text-neutral-500 hover:text-neutral-700 hover:bg-neutral-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-primary-500 transition-colors"
              data-mobile-menu-target="button"
              data-action="click->mobile-menu#toggle"
              aria-controls="mobile-menu"
              aria-expanded="false"
            >
              <span class="sr-only">Open main menu</span>
              <!-- Hamburger icon -->
              <svg data-mobile-menu-target="iconOpen" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
              </svg>
              <!-- Close icon -->
              <svg data-mobile-menu-target="iconClose" class="hidden h-6 w-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
              </svg>
            </button>

            <%= button_to "Logout", logout_path, method: :delete, class: "text-sm text-neutral-500 hover:text-neutral-700 transition-colors" %>
          </div>
        </div>
      </div>

      <!-- Mobile menu panel -->
      <div
        id="mobile-menu"
        class="sm:hidden hidden"
        data-mobile-menu-target="menu"
      >
        <div class="px-4 pt-2 pb-3 space-y-1 border-t border-neutral-200 bg-white">
          <%= link_to "Dashboard", root_path, class: current_page?(root_path) ? 'mobile-nav-link-active' : 'mobile-nav-link-inactive' %>
          <%= link_to "Accounts", accounts_path, class: current_page?(accounts_path) ? 'mobile-nav-link-active' : 'mobile-nav-link-inactive' %>
          <%= link_to "Transactions", transactions_path, class: current_page?(transactions_path) ? 'mobile-nav-link-active' : 'mobile-nav-link-inactive' %>
          <%= link_to "Rules", recurring_rules_path, class: current_page?(recurring_rules_path) ? 'mobile-nav-link-active' : 'mobile-nav-link-inactive' %>
          <%= link_to "Settings", edit_settings_path, class: current_page?(edit_settings_path) ? 'mobile-nav-link-active' : 'mobile-nav-link-inactive' %>
        </div>
      </div>
    </nav>

    <main class="max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8">
      <% if notice %>
        <%= alert_box notice, variant: :success, dismissible: true, class: "mb-6" %>
      <% end %>

      <% if alert %>
        <%= alert_box alert, variant: :danger, dismissible: true, class: "mb-6" %>
      <% end %>

      <%= yield %>
    </main>
  </body>
</html>
